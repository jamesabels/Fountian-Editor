!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("fountain-js",[],t):"object"==typeof exports?exports["fountain-js"]=t():e["fountain-js"]=t()}(this,function(){return function(e){function t(r){if(a[r])return a[r].exports;var n=a[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(1),s=r(n),i=a(6),l=r(i),c=function u(e,t){return u.parse(e,t)};c.parse=function(e,t,a){return(0,s["default"])(e,t,a)},c.parseJSON=function(e,t,a){return(0,l["default"])(e,t,a)},t["default"]=c,e.exports=t["default"]},function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),s=r(n),i=a(4),l=r(i),c=function(e,t,a){void 0===a&&"function"==typeof t&&(a=t,t=void 0);for(var r=(0,l["default"])(e),n=r.length,i=void 0,c=void 0,u=[],p=[];n--;)switch(i=r[n],i.text=s["default"].lexer(i.text),i.type){case"title":u.push("<h1>"+i.text+"</h1>"),c=i.text.replace("<br />"," ").replace(/<(?:.|\n)*?>/g,"");break;case"credit":u.push('<p class="credit">'+i.text+"</p>");break;case"author":u.push('<p class="authors">'+i.text+"</p>");break;case"authors":u.push('<p class="authors">'+i.text+"</p>");break;case"source":u.push('<p class="source">'+i.text+"</p>");break;case"notes":u.push('<p class="notes">'+i.text+"</p>");break;case"draft_date":u.push('<p class="draft-date">'+i.text+"</p>");break;case"date":u.push('<p class="date">'+i.text+"</p>");break;case"contact":u.push('<p class="contact">'+i.text+"</p>");break;case"copyright":u.push('<p class="copyright">'+i.text+"</p>");break;case"scene_heading":p.push("<h3"+(i.scene_number?' id="'+i.scene_number+'">':">")+i.text+"</h3>");break;case"transition":p.push("<h2>"+i.text+"</h2>");break;case"dual_dialogue_begin":p.push('<div class="dual-dialogue">');break;case"dialogue_begin":p.push('<div class="dialogue'+(i.dual?" "+i.dual:"")+'">');break;case"character":p.push("<h4>"+i.text+"</h4>");break;case"parenthetical":p.push('<p class="parenthetical">'+i.text+"</p>");break;case"dialogue":p.push("<p>"+i.text+"</p>");break;case"dialogue_end":p.push("</div> ");break;case"dual_dialogue_end":p.push("</div> ");break;case"section":p.push('<p class="section" data-depth="'+i.depth+'">'+i.text+"</p>");break;case"synopsis":p.push('<p class="synopsis">'+i.text+"</p>");break;case"note":p.push("<!-- "+i.text+"-->");break;case"boneyard_begin":p.push("<!-- ");break;case"boneyard_end":p.push(" -->");break;case"action":p.push("<p>"+i.text+"</p>");break;case"centered":p.push('<p class="centered">'+i.text+"</p>");break;case"page_break":p.push("<hr />");break;case"line_break":p.push("<br />");break;default:console.log("Unexpected Token type",i.type,i.text)}var o={title:c,html:{titlePage:u.join(""),script:p.join("")},tokens:t?r.reverse():void 0};return"function"==typeof a?a(o):o};t["default"]=c,e.exports=t["default"]},function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),s=r(n),i={note:"<!-- $1 -->",line_break:"<br />",bold_italic_underline:'<span class="bold italic underline">$2</span>',bold_underline:'<span class="bold underline">$2</span>',italic_underline:'<span class="italic underline">$2</span>',bold_italic:'<span class="bold italic">$2</span>',bold:'<span class="bold">$2</span>',italic:'<span class="italic">$2</span>',underline:'<span class="underline">$2</span>'};i.lexer=function(e){if(e){var t=["underline","italic","bold","bold_italic","italic_underline","bold_underline","bold_italic_underline"],a=t.length,r=void 0,n=void 0;for(e=e.replace(s["default"].note_inline,i.note).replace(/\\\*/g,"[star]").replace(/\\_/g,"[underline]").replace(/\n/g,i.line_break);a--;)r=t[a],n=s["default"][r],n.test(e)&&(e=e.replace(n,i[r]));return e.replace(/\[star\]/g,"*").replace(/\[underline\]/g,"_").trim()}},t["default"]=i,e.exports=t["default"]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={title_page:/^((?:title|credit|author[s]?|source|notes|draft date|date|contact|copyright)\:)/gim,scene_heading:/^((?:\*{0,3}_?)?(?:(?:int|ext|est|i\/e)[. ]).+)|^(?:\.(?!\.+))(.+)/i,scene_number:/( *#(.+)# *)/,transition:/^((?:FADE (?:TO BLACK|OUT)|CUT TO BLACK)\.|.+ TO\:)|^(?:> *)(.+)/,dialogue:/^([A-Z*_]+[0-9A-Z (._\-')]*)(\^?)?(?:\n(?!\n+))([\s\S]+)/,parenthetical:/^(\(.+\))$/,action:/^(.+)/g,centered:/^(?:> *)(.+)(?: *<)(\n.+)*/g,section:/^(#+)(?: *)(.*)/,synopsis:/^(?:\=(?!\=+) *)(.*)/,note:/^(?:\[{2}(?!\[+))(.+)(?:\]{2}(?!\[+))$/,note_inline:/(?:\[{2}(?!\[+))([\s\S]+?)(?:\]{2}(?!\[+))/g,boneyard:/(^\/\*|^\*\/)$/g,page_break:/^\={3,}$/,line_break:/^ {2}$/,emphasis:/(_|\*{1,3}|_\*{1,3}|\*{1,3}_)(.+)(_|\*{1,3}|_\*{1,3}|\*{1,3}_)/g,bold_italic_underline:/(_{1}\*{3}(?=.+\*{3}_{1})|\*{3}_{1}(?=.+_{1}\*{3}))(.+?)(\*{3}_{1}|_{1}\*{3})/g,bold_underline:/(_{1}\*{2}(?=.+\*{2}_{1})|\*{2}_{1}(?=.+_{1}\*{2}))(.+?)(\*{2}_{1}|_{1}\*{2})/g,italic_underline:/(?:_{1}\*{1}(?=.+\*{1}_{1})|\*{1}_{1}(?=.+_{1}\*{1}))(.+?)(\*{1}_{1}|_{1}\*{1})/g,bold_italic:/(\*{3}(?=.+\*{3}))(.+?)(\*{3})/g,bold:/(\*{2}(?=.+\*{2}))(.+?)(\*{2})/g,italic:/(\*{1}(?=.+\*{1}))(.+?)(\*{1})/g,underline:/(_{1}(?=.+_{1}))(.+?)(_{1})/g,splitter:/\n{2,}/g,cleaner:/^\n+|\n+$/,standardizer:/\r\n|\r/g,whitespacer:/^\t+|^ {3,}/gm};t["default"]=a,e.exports=t["default"]},function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),s=r(n),i=a(5),l=r(i),c=function(e){for(var t=(0,l["default"])(e).split(s["default"].splitter),a=t.length,r=void 0,n=void 0,i=void 0,c=void 0,u=void 0,p=void 0,o=void 0,d=void 0,_=[];a--;)if(r=t[a],s["default"].title_page.test(r))for(n=r.replace(s["default"].title_page,"\n$1").split(s["default"].splitter).reverse(),p=0,o=n.length;p<o;p++)i=n[p].replace(s["default"].cleaner,"").split(/\:\n*/),_.push({type:i[0].trim().toLowerCase().replace(" ","_"),text:i[1].trim()});else if(n=r.match(s["default"].scene_heading))c=n[1]||n[2],c.indexOf("  ")!==c.length-2&&((u=c.match(s["default"].scene_number))&&(u=u[2],c=c.replace(s["default"].scene_number,"")),_.push({type:"scene_heading",text:c,scene_number:u||void 0}));else if(n=r.match(s["default"].centered))_.push({type:"centered",text:n[0].replace(/>|</g,"")});else if(n=r.match(s["default"].transition))_.push({type:"transition",text:n[1]||n[2]});else if((n=r.match(s["default"].dialogue))&&n[1].indexOf("  ")!==n[1].length-2){for(n[2]&&_.push({type:"dual_dialogue_end"}),_.push({type:"dialogue_end"}),i=n[3].split(/(\(.+\))(?:\n+)/).reverse(),p=0,o=i.length;p<o;p++)c=i[p],c.length>0&&_.push({type:s["default"].parenthetical.test(c)?"parenthetical":"dialogue",text:c});_.push({type:"character",text:n[1].trim()}),_.push({type:"dialogue_begin",dual:n[2]?"right":d?"left":void 0}),d&&_.push({type:"dual_dialogue_begin"}),d=!!n[2]}else(n=r.match(s["default"].section))?_.push({type:"section",text:n[2],depth:n[1].length}):(n=r.match(s["default"].synopsis))?_.push({type:"synopsis",text:n[1]}):(n=r.match(s["default"].note))?_.push({type:"note",text:n[1]}):(n=r.match(s["default"].boneyard))?_.push({type:"/"===n[0][0]?"boneyard_begin":"boneyard_end"}):s["default"].page_break.test(r)?_.push({type:"page_break"}):s["default"].line_break.test(r)?_.push({type:"line_break"}):_.push({type:"action",text:r});return _};t["default"]=c,e.exports=t["default"]},function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),s=r(n),i=function(e){return e.replace(s["default"].boneyard,"\n$1\n").replace(s["default"].standardizer,"\n").replace(s["default"].cleaner,"").replace(s["default"].whitespacer,"")};t["default"]=i,e.exports=t["default"]},function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(4),s=r(n),i=a(2),l=r(i),c=function(e,t){if("undefined"==typeof e&&(e=[]),!Array.isArray(e))throw console.trace(),"First parameter to this function must be a proper array. Instead got: "+JSON.stringify(e);return e.push(t),e},u=function(e,t,a){void 0===a&&"function"==typeof t&&(a=t,t=void 0);var r=(0,s["default"])(e),n=r.length,i=void 0,u={};u.title_page={},u.script={},u.tokens=t?r.reverse():void 0;for(var p=[],o={type:"unknown"},d={type:"unknown"};n--;)switch(i=r[n],i.text=l["default"].lexer(i.text),i.type){case"title":u.title=i.text.replace("<br />"," ").replace(/<(?:.|\n)*?>/g,""),u.title_page.title=c(u.title_page.title,u.title);break;case"credit":u.title_page.credit=c(u.title_page.credit,i.text);break;case"author":case"authors":u.title_page.authors=c(u.title_page.authors,i.text);break;case"source":u.title_page.source=c(u.title_page.source,i.text);break;case"notes":u.title_page.notes=c(u.title_page.notes,i.text);break;case"draft_date":u.title_page.draftdate=c(u.title_page.draftdate,i.text);break;case"date":u.title_page.date=c(u.title_page.date,i.text);break;case"contact":u.title_page.contact=c(u.title_page.contact,i.text);break;case"copyright":u.title_page.copyright=c(u.title_page.copyright,i.text);break;case"scene_heading":u.script.scenes=c(u.script.scenes,p),p=[],p=c(p,{type:"heading",scene_number:i.scene_number,heading:i.text});break;case"transition":p=c(p,{type:"transition",text:i.text});break;case"dual_dialogue_begin":o.characters=c(o.characters,d),d={type:"unkown"},p=c(p,o),o={type:"dialogue-dual"};break;case"dialogue_begin":o.characters=c(o.characters,d),d={type:"unkown"},p=c(p,o),o={type:i.dual?"dialogue-dual":"dialogue-single"};break;case"character":o.characters=c(o.characters,d),d={type:"character",name:i.text};break;case"parenthetical":d.lines=c(d.lines,{type:"parenthetical",text:i.text});break;case"dialogue":d.lines=c(d.lines,{type:"line",text:i.text});break;case"dialogue_end":case"dual_dialogue_end":o.characters=c(o.characters,d),p=c(p,o),o={type:"dialogue-single"};break;case"section":p=c(p,{type:"section",name:i.text});break;case"synopsis":p=c(p,{type:"synopsis",text:i.text});break;case"note":case"boneyard_begin":case"boneyard_end":break;case"action":case"centered":p=c(p,{type:"action",text:i.text});break;case"page_break":case"line_break":break;default:console.log("Unexpected Token type",i.type,i.text)}return o.characters=c(o.characters,d),p=c(p,o),u.script.scenes=c(u.script.scenes,p),"function"==typeof a?a(u):u};t["default"]=u,e.exports=t["default"]}])});
//# sourceMappingURL=fountain-js.min.js.map